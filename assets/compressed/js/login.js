$(document).ready(function(){getcaptcha();$("#getcaptcha").click(function(){$("#captcha_img").html("loading...");getcaptcha()});var A=$.cookie("username");if(A!=undefined){$("#username").val(A)}$("#forget").click(function(){$(".login").hide();$(".forget").show();$("#error_msg").html("")});$("#back_to_login").click(function(){$(".login").show();$(".forget").hide();$("#error_msg").html("")});$("#firstname , #lastname , #inputEmail , #inputPassword").keypress(function(B){if(B.which==13){$("#signupsubmit").click()}});$("#username , #passowrd").keypress(function(B){if(B.which==13){$("#loginsubmit").click()}});$("#loginsubmit").click(function(){$("#error_msg").html("");var C=$.trim($("#username").val());var B=$("#passowrd").val();if(!validate("Email","username",man=true,max=254,min=false,type="email",disp="error_msg")){return false}else{if(!validate("Password","passowrd",man=true,max=30,min=6,type="false",disp="error_msg")){return false}else{if($("#c1").is(":checked")){$.cookie("username",C,{expires:365})}$.ajax({url:baseurl+"verifylogin",type:"POST",data:{username:C,password:B},dataType:"json",success:function(D){if(D.resultset.success=="yes"){if(D.resultset.flag==1){window.location.href=baseurl+"profile"}else{if(D.resultset.role=="user"){window.location.href=baseurl+"home"}else{if(D.resultset.role=="member"){window.location.href=baseurl+"admin"}else{if(D.resultset.role=="admin"){window.location.href=baseurl+"admin/userlist"}}}}}else{$("#error_msg").html(D.resultset.errors)}},error:function(){$("#error_msg").html("Internal error, try agian...")}})}}});$("#signupsubmit").click(function(){$(".error_msg").html("");var C=$.trim($("#inputEmail").val());valid=1;if(!validate("First Name","firstname",man=true,max=100,min=3,type="string",disp="firstname_err1")){valid=0}if(!validate("Last Name","lastname",man=true,max=100,min=false,type="string",disp="lastname_err1")){valid=0}if(!validate("Email","inputEmail",man=true,max=254,min=false,type="email",disp="email_err1")){valid=0}if(!validate("Password","inputPassword",man=true,max=30,min=6,type=false,disp="password_err1")){valid=0}if(!validate("Captcha","inputCaptcha",man=true,max=30,min=6,type=false,disp="error_msg1")){valid=0}var B=[];var E=true;var D=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;$(".friend_emails").each(function(){var F=$.trim($(this).val());if(F){if(!F.match(D)){$("#error_msg1").html("Referred Email is invalid.");E=false;valid=0}else{if(F==C){$("#error_msg1").html("You cannot refer your self.");E=false;valid=0}}B.push(F)}});if(!E){valid=0}else{if($(B).size()!=$($.unique(B)).size()){$("#error_msg1").html("You cannot refer the same person twice.");valid=0}}if(!valid){return false}$.ajax({url:baseurl+"registration",type:"POST",data:$("#registration_form").serialize(),dataType:"json",success:function(F){if(F.resultset.success=="yes"){if(F.resultset.mail=="no"){$("#error_msg1").append(" There was a problem occurred on sending mail. <br />")}if(F.resultset.html=="no"){$("#error_msg1").append(" Cannot generate download file. Try again later. <br />")}else{if(F.resultset.html=="nosession"){$(".scus-msg").append("Thank you for registering with EZCV. An activation email has been sent to your account. Please activate your account and get access to your resume.")}else{if(F.resultset.html=="nodownload"){$(".scus-msg").append("Thank you for registering with EZCV. An activation email has been sent to your account. Please activate your account and get access to your resume.")}else{window.location.replace(baseurl+"download/index/"+F.resultset.html)}}}}else{if(F.resultset.success=="already"){$("#email_err1").html(F.resultset.ex_msg)}else{$("#error_msg1").html(F.resultset.errors)}}},error:function(){$("#error_msg1").html("Internal error, try agian...")}})});$("#forgetsubmit").click(function(){$("#error_msg").html("");var B=$.trim($("#fusername").val());if(!validate("Email","fusername",man=true,max=254,min=false,type="email",disp="error_msg")){return false}else{$.ajax({url:baseurl+"forget",type:"POST",data:{username:B},dataType:"json",success:function(C){if(C.resultset.success=="yes"){$("#error_msg").html("<span class='success_msg'>We have sent you an email to reset the password for your EZCV Account. Please check your mail account.</span>")}else{$("#error_msg").html(C.resultset.errors)}},error:function(){$("#error_msg").html("Internal error, try agian...")}})}});$("#add_friend").click(function(){var B=parseInt($("#friend_count").val());var C=parseInt($("#friend_id").val());B=B+1;C=C+1;$("#friend_count").val(B);$("#friend_id").val(C);html='<tr id="fri_'+C+'">';html+='<td class="fri_count">Friend '+B+":</td>";html+='<td>&nbsp<input type="email" name="friend_email[]" class="email_check friend_emails" /></td>';html+='<td><span class="rmv_friend" data="'+C+'">-</span></td>';html+="</tr>";$("#friends_tb").append(html)});$(".rmv_friend").live("click",function(){var C=$(this).attr("data");$("#fri_"+C).remove();var B=2;$(".fri_count").each(function(){++B;$(this).html("Friend "+B+":")});$("#friend_count").val(B)})});function validate_email(A){$.ajax({url:baseurl+"registration/validateEmail/",type:"GET",data:{email:A},dataType:"json",success:function(B){if(B.resultset.success=="-1"){$("#error_msg1").html(A+" Email is invalid.");return false}else{if(B.resultset.success=="-2"){$("#error_msg1").html(A+" Email is already registered with us.");return false}}},error:function(){$("#error_msg1").html("Internal error, try agian...")}})}function getcaptcha(){$.ajax({url:baseurl+"captcha",data:$("#contactForm").serialize(),dataType:"JSON",type:"POST",success:function(A){$("#captcha_img").html(A.resultset.captcha.image);A.resultset.captcha.image;A.resultset.captcha.word},error:function(){$("#msg_disp").text("Intenal error, try again !")}})};