$(document).ready(function(){if($("#profile_flag").val()=="1"){$(".pr-view, #pr-edit-link").hide();$(".pr-edit").show();$(".img_update").attr("id","profile_pic")}if($("#primary_email").val()==$("#secondary_email").val()){$("#display_email").hide()}$("#pr-edit-link").click(function(){$(".pr-view, #pr-edit-link, #show_change_password").hide();$(".pr-edit").show();$(".img_update").attr("id","profile_pic");$(".img_update").addClass("edit_user_icon");if($("#primary_email").val()==$("#secondary_email").val()){$("#display_email").hide()}$(".scus-msg").html("")});$("#pr-cancel-link").click(function(){$(".pr-view, #pr-edit-link, #show_change_password").show();$(".pr-edit").hide();$("#uploadstate").html("");$(".img_update").attr("id","");$(".img_update").removeClass("edit_user_icon")});$("#form1").submit(function(){if(!validate("First Name","first_name",man=true,max=100,min=3,type="string",disp=false)){return false}else{if(!validate("Last Name","last_name",man=true,max=100,min=false,type="string",disp=false)){return false}else{if(!validate("Mobile Number","mobile",man=true,max=17,min=10,type="mobile",disp=false)){return false}}}if(!$("#email_toggle").is(":checked")){if(!validate("Display Email","secondary_email",man=true,max=254,min=false,type="email",disp=false)){return false}}});$("#upload_file").submit(function(A){$("#uploadstate").html("uploading..");A.preventDefault();$.ajaxFileUpload({url:baseurl+"upload/upload_file/",secureuri:false,fileElementId:"userfile",dataType:"json",success:function(C,B){$("#uploadstate").html("");if(C.status!="error"){$("#profile_pic").attr("src",C.imgUrl);$("#photo_root").val(C.imgRoot);$("#photo_name").val(C.imgName);$("#photo_ext").val(C.imgExt)}else{$("#uploadstate").html(C.msg)}},error:function(){alert("Internal error.")}});return false});$("#userfile").live("change",function(){$("#fsubmit").click()});$("#profile_pic").live("click",function(){$("#userfile").click()});$("#email_toggle").change(function(){if($("#email_toggle").is(":checked")){$("#display_email").hide()}else{$("#display_email").show()}});$("#show_change_password").click(function(){$("#change_password_div").show();$("#profile_div, #pr-edit-link, #profile_photo").hide();$(this).hide();$("#change_password_msg").html("");$(".err-msg").html("");$("#current_password").val("");$("#new_password").val("");$("#confirm_password").val("");$(".scus-msg").html("")});$("#hide_change_password").click(function(){$("#change_password_div").hide();$("#profile_div, #pr-edit-link, #profile_photo").show();$("#show_change_password").show()});$("#submit_form2").click(function(){if(!validate("Current Password","current_password",man=true,max=30,min=6,type=false,disp=false)){return false}else{if(!validate("New Password","new_password",man=true,max=30,min=6,type=false,disp=false)){return false}else{if(!validate("Confirm Password","confirm_password",man=true,max=30,min=6,type=false,disp=false)){return false}else{if(!same("New Password","Confirm Password","new_password","confirm_password")){return false}}}}$.ajax({url:baseurl+"profile/change_password",type:"POST",data:$("#form2").serialize(),dataType:"json",success:function(A){if(A.resultset.success=="yes"){$("#change_password_div").hide();$("#profile_div").show();$("#show_change_password").show();$(".scus-msg").html("Your Password has been successfully updated.");$(".pr-view, #pr-edit-link, #show_change_password, #profile_photo").show();$(".pr-edit").hide();$(".img_update").attr("id","")}else{if(A.resultset.success=="missmatch"){$("#change_password_msg").html("Incorrect current password.")}else{alert("Internal error, Please try agian!")}}},error:function(){alert("Internal error, Please try agian!")}})})});